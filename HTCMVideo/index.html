<!DOCTYPE html> 
<html lang="zh-CN"> 
<head> 
<meta charset="UTF-8"> 
<meta name="viewport" content="width=device-width, initial-scale=1.0"> 
<title>黑铁华夏每日视频 - HTCMVideo</title> 
<link rel="stylesheet" href="../css/htgov.css"> 
<style> 
html, body { 
  margin: 0!important; 
  padding: 0!important; 
} 
.header span { 
  pointer-events: none; 
  cursor: default; 
} 
.content { 
  padding-top: 0 !important; 
} 

.video-container h2 { 
  margin-top: 0 !important; /* 去掉 H2 默认外边距 */ 
} 
.container { 
  background: rgba(0, 0, 0, 0.6); 
  padding: 30px 40px; 
  border-radius: 10px; 
  box-shadow: 0 0 15px rgba(0, 0, 0, 0.5); 
  max-width: 800px; 
} 
/* 修复header定位问题 */ 
.header { 
  position: relative; 
  width: 100%; 
  height: 60px; 
  background: black; 
  display: flex; 
  align-items: center; 
  justify-content: center; 
  font-size: 20px; 
  font-weight: bold; 
  color: white; 
  box-shadow: 0 2px 5px rgba(0, 0, 0, 0.2); 
} 
/* 视频页面专属样式 */ 
.video-container { 
  padding: 40px; 
  max-width: 1200px; 
  margin: 0 auto; 
} 
.video-gallery { 
  display: grid; 
  grid-template-columns: repeat(auto-fill, minmax(300px, 1fr)); 
  gap: 30px; 
  margin-top: 30px; 
} 
.video-card { 
  background: rgba(0, 0, 0, 0.6); 
  border-radius: 8px; 
  overflow: hidden; 
  box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3); 
  transition: transform 0.3s; 
} 
.video-card:hover { 
  transform: translateY(-5px); 
} 
video { 
  width: 100%; 
  display: block; 
  background: #000; 
} 
.video-info { 
  padding: 15px; 
  color: #e0e0e0; 
} 
.video-title { 
  color: gold; 
  margin-bottom: 10px; 
  font-size: 18px; 
} 
.video-desc { 
  font-size: 14px; 
  opacity: 0.8; 
} 
#google_translate_element { 
  position: absolute; 
  top: 50px; 
  right: 10px; 
  background: rgba(0,0,0,0.9); 
  z-index: 9999; 
  padding: 8px; 
  border-radius: 5px; 
  font-size: 14px !important; /* 保证文字可见 */ 
  display: none; /* 初始隐藏，点击按钮再显示 */ 
} 

/* 半透明叶子纹理覆盖 */
.main-container::before {
  content: "";
  position: absolute;
  inset: 0;
  background: url("https://www.transparenttextures.com/patterns/leaf.png");
  opacity: 0.2;
  pointer-events: none;
}

          .main-container { 
  background: linear-gradient(160deg, #2e7d32 40%, #26a69a 100%); 
  width: 77%;       /* ✅ 背景放大 */
  height: 90%;      /* ✅ 背景放大 */
  padding: 25px;      
  display: flex; 
  justify-content: center; 
  align-items: center; 
  position: absolute;       
  top: 390px; 
  left: 250px;            /* ✅ 保持往左一点 */
  transform: translateY(-50%); 
  border-radius: 16px;      /* 圆角更柔和 */
  overflow: hidden; 
  box-shadow: 0 0 20px rgba(0,0,0,0.6);  /* 阴影更明显 */
}

/* 内容卡片缩小 */
.contain p {
  background: rgba(0, 50, 30, 0.6);
  padding: 12px 18px;         /* 缩小内边距 */
  border-radius: 8px;
  line-height: 2;           /* 减小行距 */
  max-width: 1200px;           /* 限制宽度，不会太长 */
  font-size: 20px;            /* 缩小字体 */
  box-shadow: 0 4px 10px rgba(0, 0, 0, 0.4);
  color: #e8f5e9;
  position: relative;
  z-index: 1;
}


/* 卡片边缘叶子小装饰 */
.contain p::after {
  content: "🍃";
  position: absolute;
  top: -15px;
  right: -15px;
  font-size: 28px;
  opacity: 0.9;
}
.contain p::before {
  content: "🌿";
  position: absolute;
  bottom: -15px;
  left: -15px;
  font-size: 28px;
  opacity: 0.9;
}

</style> 
<audio id="bgm" autoplay muted playsinline></audio>

<script>
const songs = [
  "https://htcb-12c7.github.io/htgov/assets/小美满1.mp4"
  "https://htcb-12c7.github.io/htgov/assets/小美满2.mp4"
  // 可以在这里添加更多歌曲URL
];

const bgm = document.getElementById("bgm");
const titleBox = document.createElement("div");
titleBox.style.cssText = `
  position: fixed; bottom: 8px; right: 12px;
  color: gold; font-size: 14px; font-weight: bold;
  text-shadow: 0 0 5px black; z-index: 9999;
`;
document.body.appendChild(titleBox);

let currentSongIndex = 0;

// ✅ 按顺序播放下一首歌曲
function playNextSong() {
  if (songs.length === 0) return;
  
  const song = songs[currentSongIndex];
  bgm.src = song;
  bgm.play().catch(err => console.log("播放失败：", err));
  titleBox.textContent = "🎵 正在播放：" + decodeURIComponent(song.split("/").pop());
  
  // 更新索引，循环播放
  currentSongIndex = (currentSongIndex + 1) % songs.length;
}

// ✅ 点击或按键解除静音
function enableBgm() {
  bgm.muted = false;
  bgm.play().catch(err => console.log("播放失败：", err));
}

document.addEventListener('click', enableBgm, { once: true });
document.addEventListener('keydown', enableBgm, { once: true });
document.addEventListener('touchstart', enableBgm, { once: true });

// ✅ 每首歌播完自动播放下一首
bgm.addEventListener("ended", playNextSong);

// ✅ 页面加载时开始播放
window.addEventListener("load", playNextSong);
</script>
</head> 
<body> 
<div class="header"> 
  <!-- 左上角 logo --> 
  <a href="https://htcb-12c7.github.io/htgov/"> 
    <img class="logo" src="../assets/HTgovIconV2.png" alt="返回主页"> 
  </a> 
  黑铁华夏轻松视频 - HTCMVideo<span>上新洗脑神曲</span> 

  <!-- Language 按钮（必须放 header 里面，才会绝对定位在右上角） --> 
  <button id="lang-toggle" style=" 
      position: absolute; 
      top: 10px; 
      right: 70px; 
      padding: 8px 16px; 
      font-size: 16px; 
      background: black; 
      color: #03a9f4; 
      border: 1px solid #03a9f4; 
      border-radius: 5px; 
      cursor: pointer; 
      font-weight: bold;"> 
      🌐 Language 
  </button> 

<!-- 头像 + 弹出卡片 -->
<div class="account-toggle" style="position: absolute; top: 10px; right: 10px;">
  <img id="userPhoto" src="https://htcb-12c7.github.io/htgov/assets/login-placeholder.svg" alt="头像"
    style="width: 40px; height: 40px; border-radius: 50%; cursor: pointer;"
    onclick="toggleAccountInfo()" />

  <div class="account-popup" id="accountPopup" style="
    display: none;
    position: absolute;
    top: 45px;
    right: 0;
    background: rgba(0,0,0,0.9);
    padding: 10px 15px;
    border-radius: 8px;
    color: white;
    z-index: 9999;
    box-shadow: 0 0 10px rgba(0,0,0,0.5);
    white-space: nowrap;
  ">

    <!-- 未登录显示登录表单 -->
    <div id="loginForm">
      <input type="email" id="email" placeholder="邮箱/用户名" style="width: 150px; margin: 3px;" />
      <input type="password" id="password" placeholder="密码" style="width: 150px; margin: 3px;" />
      <button id="loginBtn">登录</button>
      <button id="googleLoginBtn" style="background:#fff; color:#000; margin-top:5px;">使用 Google 登录</button>
    </div>

    <!-- 登录后显示/修改用户信息 -->
    <div id="userInfo" style="display:none;">
      <!-- 头像上传 -->
      <div>
        <label>头像：</label>
        <input type="file" id="updateAvatar" accept="image/*" />
        <img id="userPhotoPreview" 
             src="https://htcb-12c7.github.io/htgov/assets/login-placeholder.svg"
             style="width:60px; height:60px; border-radius:50%; margin-top:5px;" />
      </div>
      <div><strong>昵称：</strong><input id="userNickname" /></div>
      <div>
        <strong>邮箱：</strong>
        <input id="userEmail" style="width:200px;" />
        <button id="sendVerifyBtn" style="margin-left:5px;">发送验证邮件</button>
      </div>
      <div><strong>支付方式：</strong><input id="userPayMethod" /></div>
      <div><strong>支付名称：</strong><input id="userPayName" /></div>
      <div><strong>支付账号：</strong><input id="userPayAccount" /></div>
      <button id="saveBtn">保存</button>
      <button id="bindGoogleBtn" style="margin-top:10px; background:#4285F4; color:white;">
        绑定 Google 账号
      </button>
      <button id="logoutBtn">退出登录</button>
    </div>
  </div>
</div>

  <!-- Google 翻译语言框（一样放 header 里） --> 
  <div id="google_translate_element" style=" 
      position: absolute; 
      top: 50px; 
      right: 10px; 
      display: none; 
      background: rgba(0, 0, 0, 0.9); 
      padding: 8px; 
      border-radius: 5px; 
      z-index: 9999;"> 
  </div> 
</div> <!-- ✅ header 真正结束 --> 


  <div class="sidebar"> 
    <h3>视频分类</h3> 
    <ul id="sidebar-nav"></ul> 
</div>  


  <div class="main-container"> 
    <div class="contain"> 
      <P>此页面由黑铁建站/黑铁视频：HTc【黑铁CEO】搭建运营维护。此页面无暴力血腥、少儿不宜、非法的视频或音频，可放心观看。推荐去：放松阴乐，多种热门豪庭阴乐。换球系列有增强磁场、问题审核、洗脑歌曲、防洗脑歌曲</P> 
    </div> 
  </div>  
  
    <!-- 动态加载 nav.html --> 
<script> 
  fetch("nav/nav.html") 
    .then(r => r.text()) 
    .then(html => { 
      document.getElementById("sidebar-nav").innerHTML = html; 
    }) 
    .catch(err => console.error("菜单加载失败：", err)); 
</script> 
  
  <script src="HTCMVideo.js"></script> 
  <script> 
    function googleTranslateElementInit() { 
      new google.translate.TranslateElement({ 
        pageLanguage: 'zh-CN', 
        includedLanguages: 'zh-CN,en,ja,ko,fr,es,de,ru', 
        layout: google.translate.TranslateElement.InlineLayout.SIMPLE 
      }, 'google_translate_element'); 
    } 

    document.getElementById("lang-toggle").onclick = () => { 
      const el = document.getElementById("google_translate_element"); 
      el.style.display = el.style.display === "none" ? "block" : "none"; 
    }; 

    function toggleAccountInfo() { 
      const popup = document.getElementById('accountPopup'); 
      popup.style.display = popup.style.display === 'none' ? 'block' : 'none'; 
    } 
  </script> 
  <script src="https://translate.google.com/translate_a/element.js?cb=googleTranslateElementInit"></script> 
<!-- ✅ 头像弹出信息卡片逻辑 -->
<script>
  function toggleAccountInfo() {
    const popup = document.getElementById('accountPopup');
    popup.style.display = popup.style.display === 'none' ? 'block' : 'none';
  }
</script>

<!-- Firebase 登录逻辑 -->
<script type="module">
  import { initializeApp } from "https://www.gstatic.com/firebasejs/9.6.1/firebase-app.js";
  import { getAuth, signInWithEmailAndPassword, signInWithPopup,
    GoogleAuthProvider, updateEmail, sendEmailVerification,
    linkWithPopup, onAuthStateChanged, signOut } 
    from "https://www.gstatic.com/firebasejs/9.6.1/firebase-auth.js";
  import { getDatabase, ref, set, get } 
    from "https://www.gstatic.com/firebasejs/9.6.1/firebase-database.js";
  import { getStorage, ref as sRef, uploadBytes, getDownloadURL } 
    from "https://www.gstatic.com/firebasejs/9.6.1/firebase-storage.js";

  const firebaseConfig = {
    apiKey: "AIzaSyCDKAAxNpKqcSsS2onwlKANl9tLmCy6UGo",
    authDomain: "ht-chat-91e5f.firebaseapp.com",
    databaseURL: "https://ht-chat-91e5f-default-rtdb.firebaseio.com",
    projectId: "ht-chat-91e5f",
    storageBucket: "ht-chat-91e5f.firebasestorage.app",
    messagingSenderId: "325331727527",
    appId: "1:325331727527:web:d994b7241a7cc28e9dd782",
    measurementId: "G-VYV13LWP14"
  };

  const app = initializeApp(firebaseConfig);
  const auth = getAuth(app);
  const db = getDatabase(app);
  const provider = new GoogleAuthProvider();
  const storage = getStorage(app);

  // ✅ 登录
  document.getElementById("loginBtn").onclick = async () => {
    const email = document.getElementById("email").value;
    const password = document.getElementById("password").value;
    try {
      await signInWithEmailAndPassword(auth, email, password);
    } catch (err) {
      alert("登录失败: " + err.message);
    }
  };

  // ✅ Google 登录
  document.getElementById("googleLoginBtn").onclick = async () => {
    try {
      await signInWithPopup(auth, provider);
    } catch (err) {
      alert("Google 登录失败: " + err.message);
    }
  };

  // ✅ 绑定 Google
  document.getElementById("bindGoogleBtn").onclick = async () => {
    const user = auth.currentUser;
    if (!user) return alert("请先登录");
    try {
      await linkWithPopup(user, provider);
      alert("Google 账号绑定成功！");
    } catch (err) {
      alert("绑定失败: " + err.message);
    }
  };

  // ✅ 邮箱验证
  document.getElementById("sendVerifyBtn").onclick = async () => {
    const user = auth.currentUser;
    if (!user) return alert("请先登录");
    const newEmail = document.getElementById("userEmail").value;
    try {
      await updateEmail(user, newEmail);
      await sendEmailVerification(user);
      alert("验证邮件已发送，请检查邮箱");
    } catch (err) {
      alert("发送失败: " + err.message);
    }
  };

  // ✅ 保存用户信息 + 上传头像
  let newAvatarFile = null;
  document.getElementById("updateAvatar").addEventListener("change", function(e) {
    const file = e.target.files[0];
    if (!file) return;
    if (file.size > 27 * 1024 * 1024) {
      alert("图片大小不能超过27MB！");
      return;
    }
    newAvatarFile = file;
    document.getElementById("userPhotoPreview").src = URL.createObjectURL(file);
  });

  document.getElementById("saveBtn").onclick = async () => {
    const user = auth.currentUser;
    if (!user) return alert("请先登录");

    let avatarURL = document.getElementById("userPhoto").src;

    if (newAvatarFile) {
      const fileRef = sRef(storage, "avatars/" + user.uid + ".jpg");
      await uploadBytes(fileRef, newAvatarFile);
      avatarURL = await getDownloadURL(fileRef);
      document.getElementById("userPhoto").src = avatarURL;
    }

    const userRef = ref(db, "users/" + user.uid);
    await set(userRef, {
      nickname: document.getElementById("userNickname").value,
      email: document.getElementById("userEmail").value,
      payMethod: document.getElementById("userPayMethod").value,
      payName: document.getElementById("userPayName").value,
      payAccount: document.getElementById("userPayAccount").value,
      avatar: avatarURL
    });

    alert("信息已更新！");
  };

  // ✅ 登出
  document.getElementById("logoutBtn").onclick = () => {
    signOut(auth);
  };

  // ✅ 登录状态监听
  onAuthStateChanged(auth, async (user) => {
    if (user) {
      document.getElementById("loginForm").style.display = "none";
      document.getElementById("userInfo").style.display = "block";
      document.getElementById("userPhoto").src = user.photoURL || "https://htcb-12c7.github.io/htgov/assets/login-placeholder.svg";

      const userRef = ref(db, "users/" + user.uid);
      const snapshot = await get(userRef);
      if (snapshot.exists()) {
        const data = snapshot.val();
        document.getElementById("userNickname").value = data.nickname || "";
        document.getElementById("userEmail").value = data.email || user.email || "";
        document.getElementById("userPayMethod").value = data.payMethod || "";
        document.getElementById("userPayName").value = data.payName || "";
        document.getElementById("userPayAccount").value = data.payAccount || "";

	const defaultAvatar = "https://htcb-12c7.github.io/htgov/assets/login-placeholder.svg";
	document.getElementById("userPhoto").src = data.avatar || user.photoURL || defaultAvatar;
	document.getElementById("userPhotoPreview").src = data.avatar || user.photoURL || defaultAvatar;

      }
    } else {
      document.getElementById("loginForm").style.display = "block";
      document.getElementById("userInfo").style.display = "none";
      document.getElementById("userPhoto").src = defaultAvatar;
    }
  });
</script>

</body> 
</html>

