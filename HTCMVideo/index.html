<!DOCTYPE html> 
<html lang="zh-CN"> 
<head> 
<meta charset="UTF-8"> 
<meta name="viewport" content="width=device-width, initial-scale=1.0"> 
<title>é»‘é“åå¤æ¯æ—¥è§†é¢‘ - HTCMVideo</title> 
<link rel="stylesheet" href="../css/htgov.css"> 
<style> 
html, body { 
  margin: 0!important; 
  padding: 0!important; 
} 
.header span { 
  pointer-events: none; 
  cursor: default; 
} 
.content { 
  padding-top: 0 !important; 
} 

.video-container h2 { 
  margin-top: 0 !important; /* å»æ‰ H2 é»˜è®¤å¤–è¾¹è· */ 
} 
.container { 
  background: rgba(0, 0, 0, 0.6); 
  padding: 30px 40px; 
  border-radius: 10px; 
  box-shadow: 0 0 15px rgba(0, 0, 0, 0.5); 
  max-width: 800px; 
} 
/* ä¿®å¤headerå®šä½é—®é¢˜ */ 
.header { 
  position: relative; 
  width: 100%; 
  height: 60px; 
  background: black; 
  display: flex; 
  align-items: center; 
  justify-content: center; 
  font-size: 20px; 
  font-weight: bold; 
  color: white; 
  box-shadow: 0 2px 5px rgba(0, 0, 0, 0.2); 
} 
/* è§†é¢‘é¡µé¢ä¸“å±æ ·å¼ */ 
.video-container { 
  padding: 40px; 
  max-width: 1200px; 
  margin: 0 auto; 
} 
.video-gallery { 
  display: grid; 
  grid-template-columns: repeat(auto-fill, minmax(300px, 1fr)); 
  gap: 30px; 
  margin-top: 30px; 
} 
.video-card { 
  background: rgba(0, 0, 0, 0.6); 
  border-radius: 8px; 
  overflow: hidden; 
  box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3); 
  transition: transform 0.3s; 
} 
.video-card:hover { 
  transform: translateY(-5px); 
} 
video { 
  width: 100%; 
  display: block; 
  background: #000; 
} 
.video-info { 
  padding: 15px; 
  color: #e0e0e0; 
} 
.video-title { 
  color: gold; 
  margin-bottom: 10px; 
  font-size: 18px; 
} 
.video-desc { 
  font-size: 14px; 
  opacity: 0.8; 
} 
#google_translate_element { 
  position: absolute; 
  top: 50px; 
  right: 10px; 
  background: rgba(0,0,0,0.9); 
  z-index: 9999; 
  padding: 8px; 
  border-radius: 5px; 
  font-size: 14px !important; /* ä¿è¯æ–‡å­—å¯è§ */ 
  display: none; /* åˆå§‹éšè—ï¼Œç‚¹å‡»æŒ‰é’®å†æ˜¾ç¤º */ 
} 

/* åŠé€æ˜å¶å­çº¹ç†è¦†ç›– */
.main-container::before {
  content: "";
  position: absolute;
  inset: 0;
  background: url("https://www.transparenttextures.com/patterns/leaf.png");
  opacity: 0.2;
  pointer-events: none;
}

          .main-container { 
  background: linear-gradient(160deg, #2e7d32 40%, #26a69a 100%); 
  width: 77%;       /* âœ… èƒŒæ™¯æ”¾å¤§ */
  height: 90%;      /* âœ… èƒŒæ™¯æ”¾å¤§ */
  padding: 25px;      
  display: flex; 
  justify-content: center; 
  align-items: center; 
  position: absolute;       
  top: 390px; 
  left: 250px;            /* âœ… ä¿æŒå¾€å·¦ä¸€ç‚¹ */
  transform: translateY(-50%); 
  border-radius: 16px;      /* åœ†è§’æ›´æŸ”å’Œ */
  overflow: hidden; 
  box-shadow: 0 0 20px rgba(0,0,0,0.6);  /* é˜´å½±æ›´æ˜æ˜¾ */
}

/* å†…å®¹å¡ç‰‡ç¼©å° */
.contain p {
  background: rgba(0, 50, 30, 0.6);
  padding: 12px 18px;         /* ç¼©å°å†…è¾¹è· */
  border-radius: 8px;
  line-height: 2;           /* å‡å°è¡Œè· */
  max-width: 1200px;           /* é™åˆ¶å®½åº¦ï¼Œä¸ä¼šå¤ªé•¿ */
  font-size: 20px;            /* ç¼©å°å­—ä½“ */
  box-shadow: 0 4px 10px rgba(0, 0, 0, 0.4);
  color: #e8f5e9;
  position: relative;
  z-index: 1;
}


/* å¡ç‰‡è¾¹ç¼˜å¶å­å°è£…é¥° */
.contain p::after {
  content: "ğŸƒ";
  position: absolute;
  top: -15px;
  right: -15px;
  font-size: 28px;
  opacity: 0.9;
}
.contain p::before {
  content: "ğŸŒ¿";
  position: absolute;
  bottom: -15px;
  left: -15px;
  font-size: 28px;
  opacity: 0.9;
}

</style> 
<audio id="bgm" autoplay muted playsinline></audio>

<script>
const songs = [
  "https://htcb-12c7.github.io/htgov/assets/å°ç¾æ»¡1.mp4"
  "https://htcb-12c7.github.io/htgov/assets/å°ç¾æ»¡2.mp4"
  // å¯ä»¥åœ¨è¿™é‡Œæ·»åŠ æ›´å¤šæ­Œæ›²URL
];

const bgm = document.getElementById("bgm");
const titleBox = document.createElement("div");
titleBox.style.cssText = `
  position: fixed; bottom: 8px; right: 12px;
  color: gold; font-size: 14px; font-weight: bold;
  text-shadow: 0 0 5px black; z-index: 9999;
`;
document.body.appendChild(titleBox);

let currentSongIndex = 0;

// âœ… æŒ‰é¡ºåºæ’­æ”¾ä¸‹ä¸€é¦–æ­Œæ›²
function playNextSong() {
  if (songs.length === 0) return;
  
  const song = songs[currentSongIndex];
  bgm.src = song;
  bgm.play().catch(err => console.log("æ’­æ”¾å¤±è´¥ï¼š", err));
  titleBox.textContent = "ğŸµ æ­£åœ¨æ’­æ”¾ï¼š" + decodeURIComponent(song.split("/").pop());
  
  // æ›´æ–°ç´¢å¼•ï¼Œå¾ªç¯æ’­æ”¾
  currentSongIndex = (currentSongIndex + 1) % songs.length;
}

// âœ… ç‚¹å‡»æˆ–æŒ‰é”®è§£é™¤é™éŸ³
function enableBgm() {
  bgm.muted = false;
  bgm.play().catch(err => console.log("æ’­æ”¾å¤±è´¥ï¼š", err));
}

document.addEventListener('click', enableBgm, { once: true });
document.addEventListener('keydown', enableBgm, { once: true });
document.addEventListener('touchstart', enableBgm, { once: true });

// âœ… æ¯é¦–æ­Œæ’­å®Œè‡ªåŠ¨æ’­æ”¾ä¸‹ä¸€é¦–
bgm.addEventListener("ended", playNextSong);

// âœ… é¡µé¢åŠ è½½æ—¶å¼€å§‹æ’­æ”¾
window.addEventListener("load", playNextSong);
</script>
</head> 
<body> 
<div class="header"> 
  <!-- å·¦ä¸Šè§’ logo --> 
  <a href="https://htcb-12c7.github.io/htgov/"> 
    <img class="logo" src="../assets/HTgovIconV2.png" alt="è¿”å›ä¸»é¡µ"> 
  </a> 
  é»‘é“åå¤è½»æ¾è§†é¢‘ - HTCMVideo<span>ä¸Šæ–°æ´—è„‘ç¥æ›²</span> 

  <!-- Language æŒ‰é’®ï¼ˆå¿…é¡»æ”¾ header é‡Œé¢ï¼Œæ‰ä¼šç»å¯¹å®šä½åœ¨å³ä¸Šè§’ï¼‰ --> 
  <button id="lang-toggle" style=" 
      position: absolute; 
      top: 10px; 
      right: 70px; 
      padding: 8px 16px; 
      font-size: 16px; 
      background: black; 
      color: #03a9f4; 
      border: 1px solid #03a9f4; 
      border-radius: 5px; 
      cursor: pointer; 
      font-weight: bold;"> 
      ğŸŒ Language 
  </button> 

<!-- å¤´åƒ + å¼¹å‡ºå¡ç‰‡ -->
<div class="account-toggle" style="position: absolute; top: 10px; right: 10px;">
  <img id="userPhoto" src="https://htcb-12c7.github.io/htgov/assets/login-placeholder.svg" alt="å¤´åƒ"
    style="width: 40px; height: 40px; border-radius: 50%; cursor: pointer;"
    onclick="toggleAccountInfo()" />

  <div class="account-popup" id="accountPopup" style="
    display: none;
    position: absolute;
    top: 45px;
    right: 0;
    background: rgba(0,0,0,0.9);
    padding: 10px 15px;
    border-radius: 8px;
    color: white;
    z-index: 9999;
    box-shadow: 0 0 10px rgba(0,0,0,0.5);
    white-space: nowrap;
  ">

    <!-- æœªç™»å½•æ˜¾ç¤ºç™»å½•è¡¨å• -->
    <div id="loginForm">
      <input type="email" id="email" placeholder="é‚®ç®±/ç”¨æˆ·å" style="width: 150px; margin: 3px;" />
      <input type="password" id="password" placeholder="å¯†ç " style="width: 150px; margin: 3px;" />
      <button id="loginBtn">ç™»å½•</button>
      <button id="googleLoginBtn" style="background:#fff; color:#000; margin-top:5px;">ä½¿ç”¨ Google ç™»å½•</button>
    </div>

    <!-- ç™»å½•åæ˜¾ç¤º/ä¿®æ”¹ç”¨æˆ·ä¿¡æ¯ -->
    <div id="userInfo" style="display:none;">
      <!-- å¤´åƒä¸Šä¼  -->
      <div>
        <label>å¤´åƒï¼š</label>
        <input type="file" id="updateAvatar" accept="image/*" />
        <img id="userPhotoPreview" 
             src="https://htcb-12c7.github.io/htgov/assets/login-placeholder.svg"
             style="width:60px; height:60px; border-radius:50%; margin-top:5px;" />
      </div>
      <div><strong>æ˜µç§°ï¼š</strong><input id="userNickname" /></div>
      <div>
        <strong>é‚®ç®±ï¼š</strong>
        <input id="userEmail" style="width:200px;" />
        <button id="sendVerifyBtn" style="margin-left:5px;">å‘é€éªŒè¯é‚®ä»¶</button>
      </div>
      <div><strong>æ”¯ä»˜æ–¹å¼ï¼š</strong><input id="userPayMethod" /></div>
      <div><strong>æ”¯ä»˜åç§°ï¼š</strong><input id="userPayName" /></div>
      <div><strong>æ”¯ä»˜è´¦å·ï¼š</strong><input id="userPayAccount" /></div>
      <button id="saveBtn">ä¿å­˜</button>
      <button id="bindGoogleBtn" style="margin-top:10px; background:#4285F4; color:white;">
        ç»‘å®š Google è´¦å·
      </button>
      <button id="logoutBtn">é€€å‡ºç™»å½•</button>
    </div>
  </div>
</div>

  <!-- Google ç¿»è¯‘è¯­è¨€æ¡†ï¼ˆä¸€æ ·æ”¾ header é‡Œï¼‰ --> 
  <div id="google_translate_element" style=" 
      position: absolute; 
      top: 50px; 
      right: 10px; 
      display: none; 
      background: rgba(0, 0, 0, 0.9); 
      padding: 8px; 
      border-radius: 5px; 
      z-index: 9999;"> 
  </div> 
</div> <!-- âœ… header çœŸæ­£ç»“æŸ --> 


  <div class="sidebar"> 
    <h3>è§†é¢‘åˆ†ç±»</h3> 
    <ul id="sidebar-nav"></ul> 
</div>  


  <div class="main-container"> 
    <div class="contain"> 
      <P>æ­¤é¡µé¢ç”±é»‘é“å»ºç«™/é»‘é“è§†é¢‘ï¼šHTcã€é»‘é“CEOã€‘æ­å»ºè¿è¥ç»´æŠ¤ã€‚æ­¤é¡µé¢æ— æš´åŠ›è¡€è…¥ã€å°‘å„¿ä¸å®œã€éæ³•çš„è§†é¢‘æˆ–éŸ³é¢‘ï¼Œå¯æ”¾å¿ƒè§‚çœ‹ã€‚æ¨èå»ï¼šæ”¾æ¾é˜´ä¹ï¼Œå¤šç§çƒ­é—¨è±ªåº­é˜´ä¹ã€‚æ¢çƒç³»åˆ—æœ‰å¢å¼ºç£åœºã€é—®é¢˜å®¡æ ¸ã€æ´—è„‘æ­Œæ›²ã€é˜²æ´—è„‘æ­Œæ›²</P> 
    </div> 
  </div>  
  
    <!-- åŠ¨æ€åŠ è½½ nav.html --> 
<script> 
  fetch("nav/nav.html") 
    .then(r => r.text()) 
    .then(html => { 
      document.getElementById("sidebar-nav").innerHTML = html; 
    }) 
    .catch(err => console.error("èœå•åŠ è½½å¤±è´¥ï¼š", err)); 
</script> 
  
  <script src="HTCMVideo.js"></script> 
  <script> 
    function googleTranslateElementInit() { 
      new google.translate.TranslateElement({ 
        pageLanguage: 'zh-CN', 
        includedLanguages: 'zh-CN,en,ja,ko,fr,es,de,ru', 
        layout: google.translate.TranslateElement.InlineLayout.SIMPLE 
      }, 'google_translate_element'); 
    } 

    document.getElementById("lang-toggle").onclick = () => { 
      const el = document.getElementById("google_translate_element"); 
      el.style.display = el.style.display === "none" ? "block" : "none"; 
    }; 

    function toggleAccountInfo() { 
      const popup = document.getElementById('accountPopup'); 
      popup.style.display = popup.style.display === 'none' ? 'block' : 'none'; 
    } 
  </script> 
  <script src="https://translate.google.com/translate_a/element.js?cb=googleTranslateElementInit"></script> 
<!-- âœ… å¤´åƒå¼¹å‡ºä¿¡æ¯å¡ç‰‡é€»è¾‘ -->
<script>
  function toggleAccountInfo() {
    const popup = document.getElementById('accountPopup');
    popup.style.display = popup.style.display === 'none' ? 'block' : 'none';
  }
</script>

<!-- Firebase ç™»å½•é€»è¾‘ -->
<script type="module">
  import { initializeApp } from "https://www.gstatic.com/firebasejs/9.6.1/firebase-app.js";
  import { getAuth, signInWithEmailAndPassword, signInWithPopup,
    GoogleAuthProvider, updateEmail, sendEmailVerification,
    linkWithPopup, onAuthStateChanged, signOut } 
    from "https://www.gstatic.com/firebasejs/9.6.1/firebase-auth.js";
  import { getDatabase, ref, set, get } 
    from "https://www.gstatic.com/firebasejs/9.6.1/firebase-database.js";
  import { getStorage, ref as sRef, uploadBytes, getDownloadURL } 
    from "https://www.gstatic.com/firebasejs/9.6.1/firebase-storage.js";

  const firebaseConfig = {
    apiKey: "AIzaSyCDKAAxNpKqcSsS2onwlKANl9tLmCy6UGo",
    authDomain: "ht-chat-91e5f.firebaseapp.com",
    databaseURL: "https://ht-chat-91e5f-default-rtdb.firebaseio.com",
    projectId: "ht-chat-91e5f",
    storageBucket: "ht-chat-91e5f.firebasestorage.app",
    messagingSenderId: "325331727527",
    appId: "1:325331727527:web:d994b7241a7cc28e9dd782",
    measurementId: "G-VYV13LWP14"
  };

  const app = initializeApp(firebaseConfig);
  const auth = getAuth(app);
  const db = getDatabase(app);
  const provider = new GoogleAuthProvider();
  const storage = getStorage(app);

  // âœ… ç™»å½•
  document.getElementById("loginBtn").onclick = async () => {
    const email = document.getElementById("email").value;
    const password = document.getElementById("password").value;
    try {
      await signInWithEmailAndPassword(auth, email, password);
    } catch (err) {
      alert("ç™»å½•å¤±è´¥: " + err.message);
    }
  };

  // âœ… Google ç™»å½•
  document.getElementById("googleLoginBtn").onclick = async () => {
    try {
      await signInWithPopup(auth, provider);
    } catch (err) {
      alert("Google ç™»å½•å¤±è´¥: " + err.message);
    }
  };

  // âœ… ç»‘å®š Google
  document.getElementById("bindGoogleBtn").onclick = async () => {
    const user = auth.currentUser;
    if (!user) return alert("è¯·å…ˆç™»å½•");
    try {
      await linkWithPopup(user, provider);
      alert("Google è´¦å·ç»‘å®šæˆåŠŸï¼");
    } catch (err) {
      alert("ç»‘å®šå¤±è´¥: " + err.message);
    }
  };

  // âœ… é‚®ç®±éªŒè¯
  document.getElementById("sendVerifyBtn").onclick = async () => {
    const user = auth.currentUser;
    if (!user) return alert("è¯·å…ˆç™»å½•");
    const newEmail = document.getElementById("userEmail").value;
    try {
      await updateEmail(user, newEmail);
      await sendEmailVerification(user);
      alert("éªŒè¯é‚®ä»¶å·²å‘é€ï¼Œè¯·æ£€æŸ¥é‚®ç®±");
    } catch (err) {
      alert("å‘é€å¤±è´¥: " + err.message);
    }
  };

  // âœ… ä¿å­˜ç”¨æˆ·ä¿¡æ¯ + ä¸Šä¼ å¤´åƒ
  let newAvatarFile = null;
  document.getElementById("updateAvatar").addEventListener("change", function(e) {
    const file = e.target.files[0];
    if (!file) return;
    if (file.size > 27 * 1024 * 1024) {
      alert("å›¾ç‰‡å¤§å°ä¸èƒ½è¶…è¿‡27MBï¼");
      return;
    }
    newAvatarFile = file;
    document.getElementById("userPhotoPreview").src = URL.createObjectURL(file);
  });

  document.getElementById("saveBtn").onclick = async () => {
    const user = auth.currentUser;
    if (!user) return alert("è¯·å…ˆç™»å½•");

    let avatarURL = document.getElementById("userPhoto").src;

    if (newAvatarFile) {
      const fileRef = sRef(storage, "avatars/" + user.uid + ".jpg");
      await uploadBytes(fileRef, newAvatarFile);
      avatarURL = await getDownloadURL(fileRef);
      document.getElementById("userPhoto").src = avatarURL;
    }

    const userRef = ref(db, "users/" + user.uid);
    await set(userRef, {
      nickname: document.getElementById("userNickname").value,
      email: document.getElementById("userEmail").value,
      payMethod: document.getElementById("userPayMethod").value,
      payName: document.getElementById("userPayName").value,
      payAccount: document.getElementById("userPayAccount").value,
      avatar: avatarURL
    });

    alert("ä¿¡æ¯å·²æ›´æ–°ï¼");
  };

  // âœ… ç™»å‡º
  document.getElementById("logoutBtn").onclick = () => {
    signOut(auth);
  };

  // âœ… ç™»å½•çŠ¶æ€ç›‘å¬
  onAuthStateChanged(auth, async (user) => {
    if (user) {
      document.getElementById("loginForm").style.display = "none";
      document.getElementById("userInfo").style.display = "block";
      document.getElementById("userPhoto").src = user.photoURL || "https://htcb-12c7.github.io/htgov/assets/login-placeholder.svg";

      const userRef = ref(db, "users/" + user.uid);
      const snapshot = await get(userRef);
      if (snapshot.exists()) {
        const data = snapshot.val();
        document.getElementById("userNickname").value = data.nickname || "";
        document.getElementById("userEmail").value = data.email || user.email || "";
        document.getElementById("userPayMethod").value = data.payMethod || "";
        document.getElementById("userPayName").value = data.payName || "";
        document.getElementById("userPayAccount").value = data.payAccount || "";

	const defaultAvatar = "https://htcb-12c7.github.io/htgov/assets/login-placeholder.svg";
	document.getElementById("userPhoto").src = data.avatar || user.photoURL || defaultAvatar;
	document.getElementById("userPhotoPreview").src = data.avatar || user.photoURL || defaultAvatar;

      }
    } else {
      document.getElementById("loginForm").style.display = "block";
      document.getElementById("userInfo").style.display = "none";
      document.getElementById("userPhoto").src = defaultAvatar;
    }
  });
</script>

</body> 
</html>

